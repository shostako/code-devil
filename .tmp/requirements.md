# CodeDevil - 要件定義書

**作成日**: 2025-11-30
**バージョン**: 1.0
**ステータス**: Draft

---

## 1. プロジェクト概要

### 1.1 目的
プログラミング言語の関数・構文・標準ライブラリを「悪魔の辞典」スタイルで皮肉交じりに解説するリファレンスサイトを構築する。

### 1.2 解決する課題
- 公式ドキュメントは正確だが、現場の「あるある」や落とし穴が分からない
- 初心者がハマりがちな罠を事前に知る手段がない
- 真面目なドキュメントばかりで、楽しみながら学ぶ機会が少ない

### 1.3 コアバリュー
1. **皮肉による記憶定着**: 毒舌コメントで印象に残り、忘れにくい
2. **実践的な知見**: 現場で遭遇するあるあるネタ、ハマりポイントを網羅
3. **正確性との両立**: 皮肉は教育目的、本来の説明も併記

---

## 2. ユーザーストーリー（EARS形式）

### US-1: 関数を検索して詳細を閲覧
**When** ユーザーが特定の関数名を検索した時
**the system shall** 該当する関数のエントリを表示し、説明・コード例・皮肉コメントを閲覧できる
**so that** ユーザーは関数の使い方と注意点を素早く理解できる

**受け入れ基準**:
- [x] 検索バーに「print」と入力すると、print()のエントリが表示される
- [x] エントリには説明、構文、コード例、皮肉コメント（悪魔のノート）が含まれる
- [x] コード例はシンタックスハイライトされる

### US-2: 言語別にエントリを閲覧
**When** ユーザーが特定の言語（Python/JavaScript）を選択した時
**the system shall** その言語のエントリ一覧を表示する
**so that** ユーザーは興味のある言語のリファレンスを効率的に探せる

**受け入れ基準**:
- [x] トップページから言語を選択できる
- [x] 言語ページにはその言語のエントリがカード形式で一覧表示される
- [x] 各カードには関数名、皮肉タイトル、短い説明が表示される

### US-3: ダークモードで閲覧
**When** ユーザーがダークモードを好む時
**the system shall** ダークモード表示に切り替えられる
**so that** ユーザーは目に優しい環境でサイトを利用できる

**受け入れ基準**:
- [x] ヘッダーにテーマ切替ボタンがある
- [x] ライト/ダーク/システム設定の3モードを切り替えられる
- [x] 設定はブラウザに保存され、再訪問時も維持される

### US-4: 管理者がエントリを追加・編集
**When** 管理者が新しい関数解説を追加したい時
**the system shall** 管理画面からエントリをCRUD操作できる
**so that** コンテンツを継続的に拡充できる

**受け入れ基準**:
- [ ] 管理者認証（Email/Password）でログインできる
- [ ] エントリの一覧・作成・編集・削除ができる
- [ ] Markdownエディタでリアルタイムプレビューできる

### US-5: Markdownファイルからエントリを同期
**When** 開発者がMarkdownファイルでエントリを管理したい時
**the system shall** content/ディレクトリのMarkdownをDBに同期できる
**so that** Gitで履歴管理しながらコンテンツを管理できる

**受け入れ基準**:
- [ ] content/python/*.md を読み込んでDBに投入できる
- [ ] ファイルハッシュで差分検出し、変更分のみ更新できる
- [ ] CI/CDで自動同期できる

---

## 3. 機能要件

### Phase 1: MVP（必須機能）

#### FR-1.1: エントリ表示機能
- **優先度**: 必須
- **内容**: プログラミング関数/構文のエントリを表示
- **詳細**:
  - トップページで言語選択
  - 言語別エントリ一覧（カード形式）
  - エントリ詳細ページ（Markdown表示、コードハイライト）
  - 皮肉コメント表示（悪魔のノート）

#### FR-1.2: ダークモード
- **優先度**: 必須
- **内容**: ライト/ダーク/システム設定の切り替え
- **詳細**:
  - Zustandで状態管理
  - localStorageに永続化
  - Tailwind CSSのdark:クラスで実装

#### FR-1.3: 基本的な検索・フィルター
- **優先度**: 必須
- **内容**: エントリの検索とカテゴリフィルター
- **詳細**:
  - Supabase Full Text Searchで全文検索
  - カテゴリ別フィルター
  - 難易度別フィルター

### Phase 2: 拡張機能

#### FR-2.1: 管理画面
- **優先度**: 高
- **内容**: 管理者がエントリをCRUD操作できる
- **詳細**:
  - Supabase Auth（Email/Password）
  - エントリ一覧・作成・編集・削除
  - Markdownエディタ + ライブプレビュー

#### FR-2.2: Markdown同期
- **優先度**: 中
- **内容**: MarkdownファイルからDBに同期
- **詳細**:
  - content/ディレクトリ構造
  - フロントマター解析（gray-matter）
  - 差分検出（ファイルハッシュ）
  - GitHub Actions連携

---

## 4. 非機能要件

### 4.1 性能要件
- **応答速度**: 検索結果 500ms以内
- **初回ロード**: 3秒以内（LCP）

### 4.2 使いやすさ
- **学習曲線**: 初見で即座に使える直感的UI
- **アクセシビリティ**: キーボード操作対応（検索: Ctrl+K）

### 4.3 互換性
- **ブラウザ**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **デバイス**: Desktop, Tablet, Mobile（レスポンシブ）

---

## 5. 制約事項

### 5.1 技術制約
- バックエンドはSupabase（PostgreSQL）に限定
- フレームワークはNext.js 14（App Router）
- ホスティングはRender

### 5.2 開発制約
- **開発期間**: Phase 1を1-2週間で完了
- **開発体制**: Claude Code + 人間1名

---

## 6. 成功基準

### Phase 1の成功基準
- [x] Python 5件、JavaScript 5件のエントリが閲覧できる
- [x] 各エントリに皮肉コメントが表示される
- [x] ダークモードが動作する
- [ ] Supabaseからデータを取得できる

### 全体の成功基準
- [ ] 管理画面からエントリを追加できる
- [ ] Markdownファイルから同期できる
- [ ] Renderにデプロイされている

---

## 7. 今後の拡張（Phase N以降）

### 7.1 追加言語対応
- Rust, Go, TypeScript等

### 7.2 ユーザー参加型機能
- コメント、いいね、ユーザー投稿

### 7.3 クイズ機能
- DevIndexのようなクイズ・SRS機能

---

## 厳格な品質チェックリスト

### 1. 実装要求仕様
- [x] 各機能に「完了条件: 測定可能な基準」が記載済み
- [x] 全機能の入力・処理・出力が具体的に定義済み
- [x] 必須機能とオプション機能の線引きが明確
- [x] 全機能に実装優先度(高/中/低)が設定済み

### 2. UI/UX具体化
- [x] Primary FlowとAlternative Flowsが3ステップ以上で記載
- [x] 各UI要件に測定可能な完了条件が設定済み
- [x] 想定エラーとその表示方法が明記済み

### 3. Claude Code最適化
- [x] 1-3時間単位のタスクに分解可能な詳細度

### 4. 測定可能性
- [x] 「動作する」でなく「〇〇の入力で△△が表示される」レベル
- [x] 具体的な受け入れテストシナリオが2つ以上

### 5. スコープ管理
- [x] 「含むもの/含まないもの」が明確に分離
- [x] 技術制約・時間制約を現実的に設定
- [x] MVPに集中するためのスコープ制限策

### 6. ユーザー確認必須
- [ ] ユーザーが全要件を理解し合意済み ← **確認待ち**

---

**次のステップ**: `.tmp/design.md`（技術設計書）の作成

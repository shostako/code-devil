# code-devil - 技術設計書

**作成日**: 2025-11-30
**バージョン**: 1.0
**ベース**: `.tmp/requirements.md`

---

## 技術選択フレームワーク

### プロジェクト特性評価
- **アプリケーションタイプ**: {{APP_TYPE}}
- **規模**: [個人ツール/小規模アプリ/中規模システム]
- **ユーザー層**: [自分のみ/チーム/一般公開]
- **パフォーマンス要件**: [標準/高速/リアルタイム]

### 制約分析
- **既知の技術**: {{KNOWN_TECH_STACK}}
- **学習予算**: [即座/1週間/1ヶ月]
- **完了目標**: [1日/1週間/1ヶ月/長期]

### 選択の正当化
各技術選択には以下を明記：
1. **選択理由**: なぜこの技術を選んだか
2. **代替案**: 検討した他の選択肢
3. **トレードオフ**: この選択のメリット・デメリット

---

## 1. 技術スタック選択

### 1.1 プロジェクト特性
- **アプリケーション種別**: {{APP_TYPE}}
- **規模**: {{SCALE}}
- **ユーザーベース**: {{USER_BASE}}
- **パフォーマンス要件**: {{PERF_REQUIREMENTS}}

### 1.2 採用技術スタック

#### フロントエンド
| 技術 | 選定理由 |
|------|---------|
| **Next.js 14 (App Router)** | {{REASON}} |
| **TypeScript** | 型安全性、IDE支援、保守性 |
| **Tailwind CSS** | {{REASON}} |
| **Zustand** | {{REASON}} |

#### データ層
| 技術 | 選定理由 |
|------|---------|
| **{{DATABASE}}** | {{REASON}} |
| **{{SEARCH_ENGINE}}** | {{REASON}} |

#### 開発ツール
| 技術 | 選定理由 |
|------|---------|
| **Vitest** | {{REASON}} |
| **ESLint + Prettier** | コード品質・一貫性 |

### 1.3 不採用技術とその理由

#### {{REJECTED_TECH}}
- **理由**: {{REJECTION_REASON}}
- **将来拡張**: {{FUTURE_CONSIDERATION}}

---

## 2. システムアーキテクチャ

### 2.1 全体構成

```
┌─────────────────────────────────────────┐
│          Browser / PWA                  │
├─────────────────────────────────────────┤
│  UI Layer (React Components)            │
│  ├── {{VIEW_1}}                        │
│  ├── {{VIEW_2}}                        │
│  └── {{VIEW_3}}                        │
├─────────────────────────────────────────┤
│  State Management ({{STATE_LIB}})       │
│  ├── {{STORE_1}}                       │
│  └── {{STORE_2}}                       │
├─────────────────────────────────────────┤
│  Business Logic                         │
│  ├── {{LOGIC_1}}                       │
│  └── {{LOGIC_2}}                       │
├─────────────────────────────────────────┤
│  Data Layer ({{DATA_LIB}})              │
│  ├── {{TABLE_1}}                       │
│  └── {{TABLE_2}}                       │
└─────────────────────────────────────────┘
```

### 2.2 データフロー

#### 初回ロード時
```
1.
2.
3.
```

#### メイン操作時
```
1.
2.
3.
```

---

## 3. ディレクトリ構造

```
code-devil/
├── .claude/
│   └── commands/         # Claude Code カスタムコマンド
├── .tmp/                 # 仕様書（このファイル群）
├── docs/                 # ドキュメント
├── logs/                 # 作業ログ
├── public/               # 静的ファイル
├── src/
│   ├── app/              # ルーティング（App Router）
│   ├── components/       # UIコンポーネント
│   │   ├── layout/       # レイアウト系
│   │   ├── ui/           # 汎用UI
│   │   └── {{DOMAIN}}/   # ドメイン固有
│   ├── lib/              # ビジネスロジック
│   ├── hooks/            # カスタムフック
│   ├── types/            # 型定義
│   └── utils/            # ユーティリティ
├── CLAUDE.md
├── package.json
└── README.md
```

---

## 4. データモデル

### 4.1 {{MODEL_NAME}}
```typescript
interface {{ModelName}} {
  id: string;
  // ...
  created_at: string;  // ISO 8601
  updated_at: string;  // ISO 8601
}
```

### 4.2 {{MODEL_NAME_2}}
```typescript
interface {{ModelName2}} {
  id: string;
  // ...
}
```

---

## 5. API設計（該当する場合）

### 5.1 エンドポイント一覧
| Method | Path | 説明 |
|--------|------|------|
| GET | `/api/{{resource}}` | {{description}} |
| POST | `/api/{{resource}}` | {{description}} |

---

## 6. セキュリティ考慮事項

### 6.1 実装するセキュリティ対策
- [ ] XSS対策
- [ ] CSRF対策（該当する場合）
- [ ] 入力バリデーション
- [ ] 機密情報の適切な管理

### 6.2 対象外（スコープ外）
-

---

## 7. テスト戦略

### 7.1 テスト種別
| 種別 | ツール | カバレッジ目標 |
|------|--------|---------------|
| Unit | Vitest | {{TARGET}}% |
| Integration | {{TOOL}} | - |
| E2E | {{TOOL}} | 主要フロー |

### 7.2 テスト対象の優先度
1. ビジネスロジック（{{LOGIC_FILES}}）
2. データ操作（{{DATA_FILES}}）
3. UIコンポーネント

---

## 設計品質チェックリスト

### 1. 技術選択
- [ ] 全技術選択に「選択理由」が明記済み
- [ ] 代替案との比較検討が記録済み
- [ ] UI/UX優先の判断基準で選択済み
- [ ] 学習コストが現実的に評価済み

### 2. アーキテクチャ
- [ ] コンポーネント間の依存関係が明確
- [ ] データフローが図示または説明済み
- [ ] エラーハンドリング方針が定義済み
- [ ] セキュリティ考慮事項が明記済み

### 3. UI/UX設計
- [ ] 画面遷移フローが定義済み
- [ ] レスポンシブ対応方針が明記済み
- [ ] アクセシビリティ考慮事項が列挙済み
- [ ] ユーザーフィードバック方法が設計済み

### 4. 実装準備
- [ ] ディレクトリ構造が具体的に定義済み
- [ ] ファイル命名規則が決定済み
- [ ] 状態管理方針が明確
- [ ] API設計（必要な場合）が完了済み

### 5. テスト戦略
- [ ] テスト範囲が定義済み
- [ ] テストフレームワークが選定済み
- [ ] カバレッジ目標が設定済み
- [ ] E2Eテスト方針が決定済み

### 6. 品質基準
- [ ] lint/formatter設定が決定済み
- [ ] TypeScript strict modeの方針決定済み
- [ ] コードレビュー観点が列挙済み
- [ ] パフォーマンス目標値が設定済み

---

**次のステップ**: `.tmp/tasks.md`（タスクリスト）の作成
